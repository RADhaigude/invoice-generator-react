name: CI / Webhook Notification

on:
  push:
    branches:
      - dev
      - master

jobs:
  build-and-notify:
    runs-on: ubuntu-latest

    steps:
      # 1️⃣ Checkout repository
      - name: Checkout code
        uses: actions/checkout@v4

      # 2️⃣ Run simple build/test command
      - name: Run tests
        run: |
          echo "Running tests..."
          # Replace with actual test commands if needed
          echo "Tests passed!"  

      # 3️⃣ Send Teams webhook notification
      - name: Notify via Teams
        env:
          WEBHOOK_URL: ${{ secrets.TEAMS_WEBHOOK_URL }}  # Add this in your repo secrets
          STATUS: ${{ job.status }}
        run: |
          echo "Sending notification to Teams..."
          payload=$(jq -n \
            --arg title "CI / Webhook Notification" \
            --arg text "Build $STATUS for branch $GITHUB_REF_NAME in repository $GITHUB_REPOSITORY" \
            '{title: $title, text: $text}')
          curl -H "Content-Type: application/json" -d "$payload" "$WEBHOOK_URL"
